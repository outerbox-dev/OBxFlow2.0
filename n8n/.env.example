# ==========================================
# OBxFlow N8N Environment Configuration
# ==========================================
# Copy this file to .env and configure with your values
# NEVER commit .env to version control!

# ==========================================
# N8N Core Configuration
# ==========================================

# Host and Protocol
N8N_HOST=localhost
N8N_PORT=5678
N8N_PROTOCOL=http
N8N_PATH=/

# ==========================================
# Authentication
# ==========================================
# Enable basic authentication for initial setup
# TODO: Replace with SSO in production

N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# ==========================================
# Encryption (CRITICAL!)
# ==========================================
# Generate a unique encryption key:
# openssl rand -hex 32

N8N_ENCRYPTION_KEY=GENERATE_WITH_openssl_rand_hex_32

# ==========================================
# Database Configuration
# ==========================================
# N8N uses PostgreSQL for persistent storage

DB_TYPE=postgresdb
DB_POSTGRESDB_HOST=postgres
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_DATABASE=n8n
DB_POSTGRESDB_USER=n8n_user
DB_POSTGRESDB_PASSWORD=CHANGE_ME_SECURE_DB_PASSWORD

# ==========================================
# PostgreSQL Service Configuration
# ==========================================

POSTGRES_DB=n8n
POSTGRES_USER=n8n_user
POSTGRES_PASSWORD=CHANGE_ME_SECURE_DB_PASSWORD
POSTGRES_NON_ROOT_USER=n8n_user
POSTGRES_NON_ROOT_PASSWORD=CHANGE_ME_SECURE_DB_PASSWORD

# ==========================================
# Execution Settings
# ==========================================

# Execution mode: regular (default) or queue
EXECUTIONS_MODE=regular

# Timeout for workflow executions (in seconds)
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_TIMEOUT_MAX=7200

# Save execution data
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true

# ==========================================
# Timezone & Localization
# ==========================================
# Set to your timezone (OuterBox is in America/Chicago)

GENERIC_TIMEZONE=America/Chicago
TZ=America/Chicago

# ==========================================
# Webhook Configuration
# ==========================================
# URL for webhooks - update when deploying to production

WEBHOOK_URL=http://localhost:5678/

# ==========================================
# Security Settings
# ==========================================

# Disable metrics and diagnostics for privacy
N8N_METRICS=false
N8N_DIAGNOSTICS_ENABLED=false

# ==========================================
# Logging Configuration
# ==========================================

N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=console,file
N8N_LOG_FILE_LOCATION=/home/node/.n8n/logs/
N8N_LOG_FILE_COUNT_MAX=100
N8N_LOG_FILE_SIZE_MAX=16m

# ==========================================
# Custom Configuration
# ==========================================

N8N_CUSTOM_EXTENSIONS=/home/node/.n8n/custom

# ==========================================
# Additional Optional Settings
# ==========================================

# Editor configuration
# N8N_EDITOR_BASE_URL=

# Push backend (for notifications)
# N8N_PUSH_BACKEND=websocket

# Maximum payload size (in MB)
# N8N_PAYLOAD_SIZE_MAX=16

# ==========================================
# Production Settings (When Ready)
# ==========================================

# Uncomment and configure for production deployment:

# N8N_HOST=obxflow.outerbox.com
# N8N_PROTOCOL=https
# WEBHOOK_URL=https://obxflow.outerbox.com/
# N8N_BASIC_AUTH_ACTIVE=false  # Use SSO instead
# EXECUTIONS_MODE=queue  # Use queue mode for better performance

# ==========================================
# Setup Instructions
# ==========================================
# 
# 1. Copy this file to .env:
#    cp .env.example .env
#
# 2. Generate encryption key:
#    openssl rand -hex 32
#    
# 3. Set strong passwords for:
#    - N8N_BASIC_AUTH_PASSWORD
#    - DB_POSTGRESDB_PASSWORD
#    - POSTGRES_PASSWORD
#
# 4. Update N8N_HOST if not running locally
#
# 5. Start services:
#    docker-compose up -d
#
# 6. Access N8N:
#    http://localhost:5678
#
# ==========================================
